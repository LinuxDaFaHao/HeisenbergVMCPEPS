e0D8=[-56.62355455, -56.48157819, -56.62657410, -56.63492958, -56.63390190, -56.64321275, -56.64557590, -56.64750015, -56.65076167, -56.65274863, -56.65704886, -56.66349802, -56.66277687, -56.66669550, -56.66601310, -56.66474313, -56.66843996, -56.67306643, -56.66457426, -56.67159588, -56.67314864, -56.67817837, -56.67871967, -56.67453369, -56.67709940, -56.68225150, -56.68076918, -56.68243970, -56.68370381, -56.68471665, -56.68431408, -56.69085996, -56.68925399, -56.68706315, -56.68982880, -56.69242866, -56.69418619, -56.69406829, -56.70142599, -56.69921605, -56.69482026, -56.69279831, -56.69809399, -56.69953018, -56.69172073, -56.69308296, -56.70228430, -56.70634743, -56.69830303, -56.69468106, -56.70432440, -56.70123590, -56.70093241, -56.71179716, -56.70886385, -56.70814997, -56.71107059, -56.70260641, -56.70678703, -56.70513591, -56.70494950, -56.70984897, -56.71162241, -56.71302057, -56.71308547, -56.71611810, -56.71342783, -56.71493256, -56.71697411, -56.71048610, -56.71368559, -56.71060661, -56.72120137, -56.71752304, -56.71746997, -56.71910161, -56.71860457, -56.71525558, -56.72125171, -56.71661107, -56.71969280, -56.73071515, -56.72469030, -56.72755040, -56.72463781, -56.72123934, -56.71755281, -56.72301299, -56.72682739, -56.72802373, -56.72611596, -56.73158785, -56.73083871, -56.73367074, -56.72572854, -56.73594982, -56.73057498, -56.72983840, -56.72943157, -56.73260654, -56.73121099, -56.72488671, -56.73731762, -56.73819226, -56.74126201, -56.73663468, -56.74048500, -56.73752484, -56.74313222, -56.74351193, -56.74107053, -56.74751141, -56.74281728, -56.73912591, -56.74387800, -56.74721363, -56.74398565, -56.74562125, -56.74740837, -56.74804201, -56.74817170, -56.75050260, -56.75278891, -56.75177725, -56.75789821, -56.75368209, -56.75276339, -56.75328872, -56.75775566, -56.76335191, -56.76086782, -56.75852343, -56.75689267, -56.76184672, -56.75913944, -56.76331128, -56.76269311, -56.75876704, -56.76940952, -56.77398011, -56.76729796, -56.76860987, -56.77101477, -56.77645879, -56.77064016, -56.77410182, -56.77118159, -56.77592607, -56.77439420, -56.77564569, -56.77527916, -56.78000105, -56.78015389, -56.78306573, -56.78340109, -56.77925886, -56.78432146, -56.78144755, -56.78214671, -56.78289985, -56.78968998, -56.78414213, -56.79297136, -56.78955427, -56.79387729, -56.79063774, -56.78690670, -56.79196062, -56.79317059, -56.79460878, -56.79396588, -56.79914042, -56.79449426, -56.79794560, -56.79874309, -56.79952112, -56.79939869, -56.80043977, -56.80009824, -56.80649222, -56.80466710, -56.80389396, -56.80415605, -56.80234234, -56.80520855, -56.80942924, -56.80461571, -56.80787114, -56.81090821, -56.80803558, -56.80971585, -56.81431229, -56.81342372, -56.80312163, -56.81189291, -56.81564154, -56.81256243, -56.81015347, -56.81482493, -56.81262862, -56.81864481, -56.81680870, -56.81876528, -56.81706858, -56.81795783, -56.81975578, -56.81734055, -56.81605381, -56.82092123, -56.81714705, -56.81997379, -56.81912341, -56.82448663, -56.82334400, -56.82475078, -56.82419498, -56.82455715, -56.82753222, -56.82450890, -56.82680147, -56.82233997, -56.83189174, -56.82989574, -56.83266087, -56.83060583, -56.82950185, -56.82618164, -56.82722968, -56.83550452, -56.83289514, -56.82837438, -56.83235401, -56.83170321, -56.83053149, -56.83335668, -56.83072446, -56.83418472, -56.83312499, -56.83314401, -56.83813807, -56.83483875, -56.83471618, -56.83670972, -56.83875458, -56.83085102, -56.83339695, -56.83736270, -56.83236573, -56.83687564, -56.83971381, -56.83662814, -56.83848884, -56.84000972, -56.84315492, -56.83887749, -56.83968494, -56.83860892, -56.84028862, -56.84144093, -56.84291765, -56.84198147, -56.83766173, -56.83660017, -56.83980210, -56.84094261, -56.84387553, -56.84419306, -56.84197373, -56.84390599, -56.84668753, -56.84397314, -56.84489846, -56.84483791, -56.85119907, -56.84809731, -56.84811255, -56.84961725, -56.84803926, -56.85002093, -56.84755103, -56.84378992, -56.84608104, -56.84519200, -56.84618584, -56.84919130, -56.84861944, -56.84795272, -56.84731982, -56.85324251, -56.84574239, -56.85179266, -56.84992732, -56.85119298, -56.85032168, -56.85303706, -56.85471831, -56.85073055, -56.85017303, -56.85116518, -56.84911738, -56.85326515, -56.85085275, -56.85330957, -56.85203812, -56.85131121, -56.85057377, -56.85200038, -56.85295778, -56.85481372, -56.85801431, -56.85637046, -56.85713412, -56.86568886, -56.85518437, -56.85313053, -56.85199422, -56.85613157, -56.85328656, -56.85623681, -56.85642236, -56.85974754, -56.85847894, -56.85580795, -56.85712907, -56.85675556, -56.85831945, -56.85773833, -56.85670980, -56.85398518, -56.85469803, -56.85928638, -56.85752199, -56.85891972, -56.85911142, -56.85792492, -56.86226369, -56.86043091, -56.86068021, -56.86047660, -56.85817000, -56.85570632, -56.85915367, -56.85409853, -56.85600488, -56.85668973, -56.86004983, -56.86015919, -56.85596043, -56.86002266, -56.86037132, -56.86413846, -56.86362647, -56.86104600, -56.85859330, -56.86002977, -56.86045718, -56.86392732, -56.85510372, -56.85673681, -56.85755091, -56.86544967, -56.86276115, -56.86088047, -56.86447385, -56.85519872, -56.86553716, -56.86358141, -56.86157210, -56.85999482, -56.86088532, -56.86162714, -56.86211720, -56.86368805, -56.86135405, -56.86127375, -56.86497866, -56.86313585, -56.86313789, -56.86335397, -56.86308202, -56.86111548, -56.85996206, -56.85784619, -56.86302842, -56.86213384, -56.86733906, -56.86719600, -56.86682062, -56.86342519, -56.86493724, -56.86286397, -56.86535981, -56.86582583, -56.86466098, -56.86158054, -56.86865561, -56.86202572, -56.86465044, -56.86664025, -56.85894784, -56.86607485, -56.86797356, -56.86566354, -56.86718651, -56.86752280, -56.86969989, -56.86584286, -56.86817851, -56.86983355, -56.86906179, -56.86719732, -56.87033222, -56.86998447, -56.87038821, -56.86784565, -56.86883622, -56.86836839, -56.86760554, -56.87076329, -56.87203407, -56.86762128, -56.87072220, -56.87084789, -56.87024395, -56.87041977, -56.86785989, -56.86931600, -56.87061317, -56.86976199, -56.86870180, -56.87168498, -56.86934763, -56.86511504, -56.87113473, -56.86636306, -56.86755684, -56.87256538, -56.87050464, -56.87025732, -56.87057511, -56.87274335, -56.88004687, -56.87097577, -56.87187986, -56.87060757, -56.87040490, -56.87013265, -56.87240800, -56.87138581, -56.86694722, -56.86968999, -56.86881877, -56.87476711, -56.86942195, -56.87046822, -56.87160746, -56.87432358, -56.86632664, -56.87342711, -56.86756033, -56.87120237, -56.87391761, -56.87259371, -56.86932838, -56.87105831, -56.86944150, -56.86812380, -56.87543763, -56.87107739, -56.86271482, -56.87229595, -56.86802637, -56.87297192, -56.91217658, -56.87194495, -56.87372377, -56.86886630, -56.87055354, -56.87147545, -56.87285766, -56.87174405, -56.87406109, -56.87269554, -56.87214869, -56.86391997, -56.87240361, -56.87385518, -56.87083911, -56.87265382, -56.87207814, -56.87074962, -56.87041184, -56.86941458, -56.87652713, -56.87543051, -56.87200779, -56.86856847, -56.87556317, -56.87277932, -56.87228183, -56.87131201, -56.87720099, -56.87240483, -56.87201358, -56.87613312, -56.87568116, -56.87402538, -56.87402997, -56.87449386, -56.87261446, -56.87583111, -56.87247047, -56.87435313, -56.87394359, -56.87202169, -56.87199858, -56.87089282, -56.87323579, -56.87269374, -56.86895276, -56.87335093, -56.87268145, -56.87406244, -56.87210876, -56.87407041, -56.87535662, -56.87324170, -56.87266279, -56.87042619, -56.87441898, -56.87495265, -56.87325329, -56.87647995, -56.87233418, -56.87458974, -56.87109572, -56.87277295, -56.87288518, -56.87759385, -56.87410550, -56.87596317, -56.87540290, -56.87245177, -56.87453746, -56.87463108, -56.87421820, -56.87608050, -56.87253381, -56.87767196, -56.87448813, -56.87651888, -56.87678482, -56.87429473, -56.87254509, -56.87156207, -56.87682036, -56.87543009, -56.87317084, -56.87516291, -56.87514990, -56.87596469, -56.87610273, -56.87572613, -56.87422518, -56.87572587, -56.87233426, -56.87036314, -56.87257461, -56.87511371, -56.87414217, -56.87370428, -56.87499872, -56.87930052, -56.87759887, -56.87508940, -56.87483955, -56.87807325, -56.87757422, -56.87734397, -56.87389859, -56.87438361, -56.87335862, -56.87621595, -56.87653549, -56.87572377, -56.88032829, -56.87204274, -56.87791906, -56.87691136, -56.87356994, -56.87421298, -56.87749586, -56.87402737, -56.87750534, -56.87609227, -56.87692755, -56.87484210, -56.87913885, -56.87273776, -56.87552802];
e0D10=[-56.65370564, -56.50340308, -56.65605436, -56.66583215, -56.67126543, -56.67250648, -56.67728349, -56.68128016, -56.68420788, -56.68665750, -56.68712673, -56.69013164, -56.69088440, -56.69090070, -56.69726063, -56.69798050, -56.69790726, -56.69885828, -56.70007675, -56.70343353, -56.70595699, -56.70820058, -56.70870259, -56.71015630, -56.71159843, -56.71106561, -56.71464469, -56.71573599, -56.71530616, -56.71699475, -56.71748790, -56.71822747, -56.71920901, -56.72139514, -56.72276444, -56.72436264, -56.72476780, -56.72345497, -56.72454572, -56.72586786, -56.72812752, -56.72802902, -56.73003238, -56.72987701, -56.73192330, -56.73044405, -56.73273108, -56.73557541, -56.73453105, -56.73373542, -56.73437760, -56.73848723, -56.73644756, -56.73947263, -56.73756564, -56.74176063, -56.74101982, -56.74118697, -56.74049318, -56.74066956, -56.74209809, -56.74412737, -56.74360776, -56.74418721, -56.74386027, -56.74568370, -56.74807074, -56.74565981, -56.74877467, -56.74881416, -56.74849764, -56.75029065, -56.75348328, -56.75501516, -56.75245920, -56.75258292, -56.75261872, -56.75263686, -56.75403777, -56.75408107, -56.75544233, -56.75840135, -56.75983828, -56.75953580, -56.75961618, -56.75745448, -56.76067607, -56.76431398, -56.76162289, -56.76206330, -56.76481551, -56.76060802, -56.76765082, -56.76101959, -56.76811970, -56.77100600, -56.76748716, -56.76721633, -56.77005938, -56.77252589, -56.77289008, -56.77196585, -56.77569156, -56.77392371, -56.77577949, -56.77610761, -56.77630814, -56.77608697, -56.77836810, -56.77823031, -56.78033291, -56.78021135, -56.78013470, -56.78464435, -56.78535410, -56.78354730, -56.78374545, -56.78892404, -56.78566340, -56.78402186, -56.79036027, -56.78615501, -56.78928425, -56.79197509, -56.79062476, -56.79310884, -56.79162137, -56.79097781, -56.79185720, -56.79431858, -56.79231645, -56.78956007, -56.79978139, -56.79869939, -56.80049768, -56.79785529, -56.79897861, -56.79930205, -56.80025856, -56.80271731, -56.80103737, -56.80229418, -56.80545201, -56.80333879, -56.80630318, -56.80806174, -56.80585721, -56.80699478, -56.80942902, -56.81069066, -56.81067703, -56.81222805, -56.81514454, -56.81225402, -56.81254577, -56.80931831, -56.81034131, -56.81273817, -56.80548832, -56.81031018, -56.81007962, -56.81144119, -56.80921893, -56.81510097, -56.81136206, -56.80906567, -56.81035514, -56.81013575, -56.80943920, -56.80869664, -56.81186098, -56.80956549, -56.80828415, -56.80578250, -56.81040103, -56.81605566, -56.81088452, -56.80504621, -56.81114843, -56.81323398, -56.80742780, -56.81186832, -56.81660211, -56.81310776, -56.80567471, -56.81214417, -56.81804134, -56.81081678, -56.81020521, -56.81557253, -56.81435597, -56.81808495, -56.82016629, -56.81276840, -56.82119935, -56.81679910, -56.81896808, -56.82073493, -56.81385230, -56.82232018, -56.81668515, -56.82205661, -56.81853347, -56.81845791, -56.86343845, -56.81796271, -56.82638751, -56.82197653, -56.82226279, -56.82494917, -56.82615637, -56.82505538, -56.82253885, -56.82527892, -56.82715374, -56.83083297, -56.82645217, -56.82619207, -56.82670725, -56.82986926, -56.83200235, -56.83048368, -56.82835271, -56.83045979, -56.83281201, -56.82510902, -56.83000722, -56.83472851, -56.83495054, -56.83014034, -56.83233633, -56.83496945, -56.82791215, -56.83574794, -56.83182139, -56.83569004, -56.83506761, -56.83372655, -56.84511002, -56.83822676, -56.83015747, -56.83654207, -56.84213349, -56.83776907, -56.83814630, -56.84224581, -56.84201935, -56.83413286, -56.84140948, -56.84359418, -56.83644864, -56.83393840, -56.83855402, -56.83955787, -56.84085211, -56.83499563, -56.84111271, -56.84030371, -56.83618698, -56.84294928, -56.84403539, -56.84200003, -56.84253995, -56.84417871, -56.84088256, -56.84592293, -56.84452725, -56.83967922, -56.84365099, -56.84975928, -56.84408945, -56.84479334, -56.84682294, -56.84272347, -56.84702576, -56.85040482, -56.84490194, -56.84589962, -56.84571855, -56.84155819, -56.84743502, -56.84917334, -56.84207375, -56.84978064, -56.85124126, -56.85057625, -56.84709206, -56.85502855, -56.85423265, -56.85298817, -56.84263964, -56.84815058, -56.84867229, -56.85139484, -56.85166317, -56.85220652, -56.84885722, -56.84903974, -56.85412871, -56.85297450, -56.85455365, -56.84714648, -56.84615682, -56.84879258, -56.85609995, -56.85158775, -56.85112371, -56.85485590, -56.85373930, -56.85199419, -56.85166835, -56.85603135, -56.85616477, -56.85708123, -56.84995739, -56.85926066, -56.85299808, -56.85502610, -56.85262675, -56.84996546, -56.85567850, -56.85405172, -56.85510298, -56.85611436, -56.86003825, -56.85653920, -56.85620304, -56.85420986, -56.85919773, -56.85708653, -56.85805623, -56.85588888, -56.86319352, -56.85967552, -56.85568062, -56.86001875, -56.85509681, -56.85862795, -56.85964203, -56.85921371, -56.86102800, -56.86206787, -56.85801256, -56.86155825, -56.85973325, -56.86387842, -56.85935357, -56.86115644, -56.86150387, -56.86047984, -56.86220757, -56.86254991, -56.86288030, -56.86042746, -56.86421111, -56.85896413, -56.85632198, -56.86471470, -56.85909491, -56.86249756, -56.85794660, -56.85760461, -56.86204816, -56.86495892, -56.86449806, -56.86042912, -56.86195602, -56.85999405, -56.86010601, -56.85957766, -56.86522374, -56.85717046, -56.86107285, -56.86033395, -56.86521476, -56.85911019, -56.86466132, -56.86377990, -56.86498820, -56.86144551, -56.86483659];
e0D12=[-56.67384293, -56.52632914, -56.67174631, -56.67903322, -56.68276627, -56.68676617, -56.68954542, -56.67313763, -56.51791614, -56.67012517, -56.67955261, -56.68282753, -56.68840688, -56.68890184, -56.69363370, -56.69308204, -56.69853396, -56.69950370, -56.70218788, -56.70554784, -56.70513482, -56.70859841, -56.70840236, -56.71006876, -56.71170023, -56.71481317, -56.71618156, -56.71852763, -56.71738660, -56.71776926, -56.72052279, -56.72467550, -56.72570996, -56.72514361, -56.72798876, -56.72812165, -56.72985455, -56.72761487, -56.72741283, -56.73129778, -56.73113872, -56.73504326, -56.73490870, -56.73441985, -56.73457520, -56.73654962, -56.73587038, -56.73822215, -56.73849253, -56.73935251, -56.73980909, -56.74110998, -56.74335786, -56.74214242, -56.74174484, -56.74401100, -56.74287463];

e0_ex =[-56.9319805087267028];

h1 = plot(e0D8, 'o' ,'LineWidth', 2); hold on;
h2 = plot(e0D10, 'o' ,'LineWidth', 2); hold on;
h3 = plot(e0D12, 'o' ,'LineWidth', 2); hold on;

h4 = yline(e0_ex,'r--');

l=legend([h1, h2,h3,h4], { '$D=8$', ...
    ' $10$', '12','DMRG $D=12000$'});
set(l,'Box','off');set(l,'Interpreter','latex');
set(l,'Fontsize',18);
set(l,'Location','NorthWest');

xlabel('Iteration','Interpreter','latex')
% ylabel('Persite energy $e_0$','Interpreter','latex')
ylabel('energy','Interpreter','latex')
set(gca,'fontsize',24);
set(gca,'linewidth',1.5);
set(get(gca,'Children'),'linewidth',2); % Set line width 1.5 pounds
set(get(gca,'XLabel'),'FontSize',24);
set(get(gca,'YLabel'),'FontSize',24);
set(gcf, 'position',  [100, 100, 900, 600]);

hold off;

inset_axes = axes('Position', [0.5, 0.5, 0.35, 0.35]);

plot((e0D8 - e0_ex) / abs(e0_ex), 'o', 'LineWidth', 2);hold on;
plot((e0D10 - e0_ex) / abs(e0_ex), 'o', 'LineWidth', 2);
plot((e0D12 - e0_ex) / abs(e0_ex), 'o', 'LineWidth', 2);

set(gca, 'YScale', 'log');
set(gca, 'fontsize', 16);
set(gca, 'linewidth', 1.5);
set(get(gca, 'Children'), 'linewidth', 2);
ylabel('energy relative error','Interpreter','latex')
box on;


figure_directory = './';
figure_name_eps = 'EnergyDecreasingKagome4x4SmoothBC.eps';
figure_path = fullfile(figure_directory, figure_name_eps);
saveas(gcf, figure_path, 'epsc');
disp(['Energy deceasing of the heisenberg model: ', figure_path]);