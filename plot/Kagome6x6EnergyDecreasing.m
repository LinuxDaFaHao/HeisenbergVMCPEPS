e0D8=[-45.87612868, -44.73217172, -45.85571876, -45.86839622, -45.87764624, -45.88503151, -45.89210967, -45.89016815, -45.89820101, -45.89622139, -45.89776091, -45.89776379, -45.89886120, -45.90073328, -45.90332423, -45.90658685, -45.90604058, -45.90634302, -45.90619303, -45.91478236, -45.91217931, -45.91060428, -45.91233211, -45.91575235, -45.92350948, -45.91770245, -45.91832596, -45.92680015, -45.91926939, -45.92177277, -45.92447348, -45.91702192, -45.92719744, -45.92742357, -45.92518211, -45.92472429, -45.92152860, -45.92881520, -45.92675269, -45.92777493, -45.92940476, -45.92860897, -45.93226869, -45.93367709, -45.93606511, -45.93576531, -45.93446195, -45.93437949, -45.93642953, -45.93572739, -45.93571627, -45.93390587, -45.93798914, -45.93880615, -45.93835991, -45.93610383, -45.94321653, -45.94319634, -45.94550603, -45.94309576, -45.94367544, -45.94465764, -45.94024031, -45.94075049, -45.94946018, -45.94502641, -45.94293258, -45.95048286, -45.94549812, -45.95024698, -45.94979185, -45.94734157, -45.94632342, -45.94648554, -45.94928414, -45.95217296, -45.95442400, -45.94954391, -45.95164006, -45.94891367, -45.95123747, -45.95221017, -45.95210968, -45.95568580, -45.95740669, -45.95145499, -45.95485848, -45.95037429, -45.95686627, -45.95118520, -45.95569534, -45.95576177, -45.95918086, -45.95588685, -45.95727913, -45.96053919, -45.95880892, -45.95298333, -45.95973444, -45.95049042, -45.95659796, -45.96249994, -45.95649503, -45.95587082, -45.95869138, -45.96230541, -45.96011186, -45.95809449, -45.96403569, -45.96159084, -45.95931521, -45.96262623, -45.95782926, -45.96560957, -45.96765394, -45.96390467, -45.95928646, -45.96641483, -45.96391515, -45.96205423, -45.96230446, -45.95805143, -45.96084287, -45.96972297, -45.96258313, -45.96352104, -45.96692961, -45.97453523, -45.96828944, -45.96656185, -45.97350922, -45.96972989, -45.97081205, -45.96191452, -45.96936542, -45.96953189, -45.97062923, -45.97013187, -45.96745616, -45.96811923, -45.96924181, -45.96501585, -45.97082876, -45.96643266, -45.96676604, -45.96382037, -45.97110034, -45.96709856, -45.97321499, -45.97145634, -45.97337880, -45.97101720, -45.97373001, -45.97074866, -45.97424709, -45.97463503, -45.97791070, -45.97614429, -45.97871689, -45.97410087, -45.97478602, -45.97244406, -45.97396488, -45.97768523, -45.97506232, -45.97777897, -45.97237874, -45.97619431, -45.97168532, -45.97470863, -45.97868154, -45.97700311, -45.97644613, -45.97750735, -45.98159032, -45.97215093, -45.97800160, -45.97638092, -45.97604082, -45.97843615, -45.97052694, -45.98283192, -45.97523570, -45.97644481, -45.97809980, -45.97908938, -45.97334888, -45.97347141, -45.97904089, -45.98024340, -45.98171372, -45.97861277, -45.98124788, -45.97476650, -45.98016990, -45.98242826, -45.98140412, -45.98091651, -45.97933890, -45.98006057, -45.98433164, -45.97606812, -45.98147968, -45.98088231, -45.97811377, -45.98236141, -45.98568861, -45.98747218, -45.98725925, -45.98486282, -45.98028781, -45.97921444, -45.97551491, -45.98364561, -45.97949512, -45.98060075, -45.97370612, -45.97482571, -45.97588482, -45.98129421, -45.97381554, -45.98209707, -45.98035897, -45.97971913, -45.98189933, -45.98389128, -45.97903011, -45.98351201, -45.98265594, -45.97808077, -45.98162647, -45.97883820, -45.98341568, -45.98944235, -45.97940549, -45.97940938, -45.98511730, -45.98467336, -45.99187672, -45.98922868, -45.98974172, -45.98759627, -45.97899371, -45.98525749, -45.98272960, -45.97803037, -45.98973909, -45.98604645, -45.98626081, -45.98628741, -45.98858151, -45.99099450, -45.99505755, -45.98580831, -45.98743172, -45.98878927, -45.99098349, -45.99003827, -45.98786063, -45.98760942, -45.99237486, -45.99576810, -45.99132710, -45.99045819, -45.98837579, -45.99462414, -45.99351968, -45.99227398, -45.99373407, -45.99947328, -45.99439567, -45.99618698, -45.99701528, -45.99964771, -45.99515690, -45.99674313, -45.99761444, -45.99185457, -45.99560783, -45.99751539, -45.99875487, -45.99390302, -45.99676353, -45.99665221, -46.00208395, -46.00069488, -45.99819910, -45.99947882, -45.99603444, -45.99755396, -46.00232335, -45.99948803, -46.00422309, -46.00137114, -46.00704713, -46.00179468, -45.99900620, -46.00024099, -45.99364539, -46.00420048, -46.00321187, -46.00422044, -46.00461900, -46.00492271, -46.00283118, -46.00472338, -46.00090036, -46.00722813, -46.00627865, -46.00262219, -46.00552898, -46.00518888, -46.00857152, -46.00796834, -46.00691415, -46.00686190, -46.00830031, -46.00877618, -46.00475548, -46.01199698, -46.00611763, -46.00847248, -46.01074668, -46.00621848, -46.00702083, -46.01085246, -46.01249141, -46.00576306, -46.00326773, -46.01170498, -46.00818871, -46.01272977, -46.01463961, -46.01408676, -46.01262576, -46.01386426, -46.01211506, -46.01430207, -46.01047760, -46.01420397, -46.01451597, -46.01183551, -46.01498478, -46.01738927, -46.01420551, -46.01435436, -46.01628870, -46.01351461, -46.01589918, -46.01641586, -46.01555580, -46.01214797, -46.01637148, -46.01622563, -46.01877866, -46.01668655, -46.01931671, -46.01903414, -46.01980433, -46.01439394, -46.02056703, -46.01947237, -46.01970995, -46.01944094, -46.01926978, -46.01786500, -46.01733649, -46.01754168, -46.02044113, -46.01847769, -46.02110678, -46.02064396, -46.01809919, -46.01907745, -46.01980883, -46.02326104, -46.01835818, -46.01832850, -46.02043908, -46.02574909, -46.02007275, -46.02187825, -46.01986943, -46.02048202, -46.02482797, -46.02486176, -46.02418974, -46.01455342, -46.02267961, -46.02188349, -46.02344447, -46.02575639, -46.02221965, -46.02439400, -46.02564378, -46.02571714, -46.02018397, -46.02359422, -46.02695696, -46.02274061, -46.02484883, -46.02818441, -46.02437514, -46.02217541, -46.02495477, -46.02230629, -46.02157108, -46.02248782, -46.02848906, -46.02003643, -46.02118119, -46.02189566, -46.02627752, -46.02622538, -46.02204986, -46.02225586, -46.02389229, -46.02518151, -46.02478199, -46.02452257, -46.02271634, -46.02377197, -46.02204924, -46.02467683, -46.02587355, -46.02654173, -46.02860708, -46.02877763, -46.02488341, -46.02624903, -46.02549601, -46.02526988, -46.02612772, -46.02464021, -46.02401781, -46.02467852, -46.02504479, -46.02527780, -46.02502183, -46.02723851, -46.02498110, -46.02645932, -46.02634919, -46.02783657, -46.03197681, -46.02924687, -46.02605230, -46.02639008, -46.02447373, -46.02761878, -46.02746254, -46.02768675, -46.02993724, -46.02697312, -46.02456128, -46.02541791, -46.03090516, -46.03163540];
e0D8iPEPS=[-38.98491206, -39.56559701, -40.06713256, -40.50110980, -40.85620839, -41.15104290, -41.37675028, -41.60420530, -41.79653110, -41.95335524, -42.12783837, -42.24001567, -42.37043656, -42.49679948, -42.60614524, -42.72967450, -42.80222663, -42.89498707, -42.98798461, -43.05565465, -43.14785053, -43.22446468, -43.28226171, -43.41790563, -43.51828992, -43.63464975, -43.74553718, -43.81861370, -43.93882523, -44.01376465, -44.11223846, -44.17878217, -44.24177507, -44.32808089, -44.38237095, -44.45143056, -44.48574315, -44.55476367, -44.58743291, -44.64162269, -44.68470036, -44.72492062, -44.75654372, -44.78724358, -44.80518021, -44.84556644, -44.87373574, -44.89948881, -44.91444296, -44.94669189, -44.96591013, -44.98829595, -45.00547086, -45.03465678, -45.05166262, -45.07170274, -45.09163627, -45.09701622, -45.12068717, -45.12628468, -45.15286428, -45.16919319, -45.18230428, -45.19991076, -45.21180958, -45.22983073, -45.25953276, -45.27141438, -45.27665705, -45.29766580, -45.32494114, -45.33675590, -45.35529400, -45.37458601, -45.37904800, -45.39365925, -45.40844391, -45.41881954, -45.44697500, -45.45080372, -45.46757087, -45.47977288, -45.50088797, -45.50378465, -45.52845853, -45.52504552, -45.54064599, -45.55850002, -45.56000854, -45.57082142, -45.58593996, -45.59421400, -45.60411559, -45.61820796, -45.63307599, -45.64247513, -45.64636862, -45.67269340, -45.67709421, -45.69588447, -45.69654163, -45.71487850, -45.71022735, -45.72306343, -45.74390206, -45.74335040, -45.76055814, -45.76832221, -45.77435082, -45.78944027, -45.79609349, -45.79419221, -45.80071146, -45.80642987, -45.81796411, -45.82918197, -45.83263478, -45.83351376, -45.83848838, -45.84642668, -45.85135083, -45.86026973, -45.85930682, -45.84724543, -45.86167795, -45.86135240, -45.87098310, -45.88429273, -45.87406690, -45.88195554, -45.88759582, -45.89063993, -45.88851246, -45.88713726, -45.89285056, -45.89170035, -45.89560716, -45.89483683, -45.90231251, -45.90165445, -45.90396909, -45.91245997, -45.90834631, -45.91473825, -45.90923463, -45.90435801, -45.90841375, -45.90560531, -45.90976167, -45.91471220, -45.91830831, -45.91620519, -45.91240214, -45.91556910, -45.91958122, -45.92068029, -45.92378112, -45.92691780, -45.91569908, -45.92631619, -45.92380715, -45.91846392, -45.92205239, -45.93128094, -45.92442637, -45.92842047, -45.93144256, -45.93283757, -45.93057176, -45.92665788, -45.93717675, -45.92559983, -45.93444682, -45.92647894, -45.92756901, -45.93539173, -45.92935791, -45.93196184, -45.94137608, -45.93579281, -45.93402444, -45.93590386, -45.94047634, -45.94059002, -45.94411308, -45.95116677, -45.95371602, -45.94318956, -45.95106697, -45.95432561, -45.95257913, -45.95141202, -45.95155694, -45.95299230, -45.95272299, -45.95216098, -45.95074000, -45.95090319, -45.95388784, -45.95627002, -45.95046361, -45.95318088, -45.95817754, -45.95255197, -45.96150910, -45.95797442, -45.95082864, -45.94586585, -45.95622080, -45.95456890, -45.95400975, -45.95856571, -45.96206621, -45.95443630, -45.95422366, -45.96202776, -45.96462324, -45.95741282, -45.96056777, -45.95946917, -45.95247863, -45.95563450, -45.95865860, -45.95380223, -45.96354788, -45.96759127, -45.96327285, -45.96374084, -45.96025077, -45.96443062, -45.96094172, -45.95291610, -45.96022952, -45.96323292, -45.96410400, -45.96560472, -45.96401970, -45.96601200, -45.96241451, -45.96396457, -45.96697492, -45.96117885, -45.96673399, -45.95799019, -45.96498534, -45.95997547, -45.96542758, -45.96431486, -45.96595137, -45.96871610, -45.96261400, -45.97200222, -45.96364672, -45.96867964, -45.96436834, -45.96355975, -45.96116982, -45.96121041, -45.96787142, -45.97190213, -45.97089593, -45.96469626, -45.97194458, -45.96976751, -45.96647780, -45.96957723, -45.96873659, -45.96888469, -45.97006355, -45.97082024, -45.97008247, -45.96894414, -45.96200003, -45.96927284, -45.96624634, -45.97038260, -45.96662124, -45.97667816, -45.97336957, -45.97185259, -45.97209256, -45.96543070, -45.96836827, -45.97184474, -45.97708335, -45.97632366, -45.97123168, -45.98029079, -45.97290665, -45.97322248, -45.97538737, -45.97220130, -45.97297255, -45.97276158, -45.97713408, -45.97080511, -45.97428325, -45.97301823, -45.97889710, -45.97561882, -45.97862940, -45.97613845, -45.97490923, -45.97904110, -45.97826943, -45.97846132, -45.97929869, -45.97353522, -45.97732212, -45.97181934, -45.97851786, -45.97980782, -45.98104664, -45.97856151, -45.97999172, -45.97543300, -45.98260105, -45.97869465, -45.98121246, -45.98124090, -45.98190808, -45.97784245, -45.97548193, -45.97817366, -45.97709741, -45.97882154, -45.97952225, -45.97916085, -45.98056677, -45.97724730, -45.98159611, -45.97854940, -45.98202083, -45.98592072, -45.98308045, -45.98265305, -45.98149662, -45.98095072, -45.97789981, -45.97606676, -45.97906919, -45.98164165, -45.98661635, -45.98348865, -45.98246790, -45.98377230, -45.98144646, -45.98254667, -45.98530670, -45.98635723, -45.97967551, -45.98200839, -45.98567696, -45.98846630, -45.98648797, -45.98525884, -45.98376876, -45.98109860, -45.98521193, -45.98362209, -45.98310300, -45.98679054, -45.98660772, -45.98946591, -45.98228606, -45.98550808, -45.98620922, -45.98497460, -45.98581226, -45.98648030, -45.99009829, -45.98258571, -45.98938583, -45.98493064, -45.98660229, -45.98185714, -45.98264036, -45.98825434, -45.98873050, -45.98601131, -45.98499893, -45.98311];
e0D10=[-45.91265394, -45.85477841, -45.90564304, -45.91770935, -45.92148000, -45.92377547, -45.93167525, -45.92854557, -45.93144681, -45.93994571, -45.93545882, -45.94066798, -45.93847801, -45.94473501, -45.94503028, -45.94583644, -45.94690206, -45.94898585, -45.95195738, -45.95213312, -45.95184583, -45.95473272, -45.95179290, -45.95722119, -45.95935117, -45.96037666, -45.96028352, -45.96208361, -45.96045396, -45.96219659, -45.96588938, -45.96771858, -45.96955205, -45.96801001, -45.96726750, -45.96535917, -45.97005759, -45.96725904, -45.97590419, -45.97300403, -45.97206024, -45.97288837, -45.97397323, -45.97418051, -45.97733086, -45.97559970, -45.97620307, -45.98146999, -45.97741634, -45.97927629, -45.97999143, -45.97927456, -45.98160508, -45.98072709, -45.98336356, -45.98413707, -45.98340905, -45.98260672, -45.98809161, -45.98555017, -45.98522743, -45.98500338, -45.99311093, -45.98737208, -45.99143319, -45.98732494, -45.98711827, -45.98884604, -45.98820738, -45.99190772, -45.99251220, -45.99159818, -45.99006028, -45.99184303, -45.99289169, -45.99250200, -45.99596460, -45.99478002, -45.99644313, -45.99486849, -45.99528583, -45.99326449, -46.00000575, -45.99738427, -45.99936510, -46.00053215, -46.00113188, -45.99915911, -46.00027130, -45.99701000, -45.99778435, -46.00077733, -45.99827970, -46.00180385, -46.00329486, -46.00607698, -46.00260228, -46.00478668, -46.00559377, -46.00326964, -46.00787702, -46.00358247, -46.00873216, -46.00569030, -46.00472296, -46.00783132, -46.00679972, -46.00565928, -46.00541897, -46.00981355, -46.00758213, -46.01001585, -46.00732514, -46.01060887, -46.01037510, -46.00995237, -46.00983032, -46.01206513, -46.01621606, -46.01431910, -46.01127906, -46.01515880, -46.01106009, -46.00847346, -46.01303401, -46.01605411, -46.01338619, -46.01391584, -46.01548614, -46.01491719, -46.01504603, -46.01582206, -46.01601113, -46.01623870, -46.01613816, -46.01713060, -46.01896648, -46.01480191, -46.02186374, -46.01516546, -46.01521161, -46.01809239, -46.01657165, -46.01943824, -46.02264402, -46.01827324, -46.02417294, -46.02561768, -46.02406708, -46.02104742, -46.02575547, -46.02262697, -46.02028266, -46.02072912, -46.02321938, -46.02578809, -46.02330059, -46.02337906, -46.02213131, -46.02399042, -46.02235659, -46.02459081, -46.02312947, -46.02681639, -46.02647682, -46.02309209, -46.02614089, -46.02616206, -46.02906354, -46.02560001, -46.02610719, -46.02820788, -46.02941756, -46.02822314, -46.03063954, -46.02975747, -46.02974000, -46.02890924, -46.02592347, -46.02901554, -46.03037843, -46.02977615, -46.02883469, -46.02957120, -46.03361008, -46.02974155, -46.03225755, -46.03097816, -46.03182199, -46.03425551, -46.03157815, -46.03100303, -46.03201790, -46.03468418, -46.03257286, -46.03353763, -46.02955241, -46.03137564, -46.03334155, -46.03043403, -46.03509937, -46.03792017, -46.03276811, -46.03379709, -46.03355978, -46.03490721, -46.03512438, -46.03701119, -46.03511884, -46.03241229, -46.03397912, -46.03842586, -46.03763288, -46.03765942, -46.03847498, -46.03490733, -46.03210862, -46.03566326, -46.03676114, -46.03805635, -46.03709838, -46.04149149, -46.03850822, -46.04123409, -46.03662152, -46.03812475, -46.03840581, -46.03572067, -46.03844064, -46.04096185, -46.04222995, -46.03522569, -46.04085403, -46.04156361, -46.03958756, -46.04114417, -46.04138071, -46.03913428, -46.04080299, -46.03737309, -46.03758916, -46.04250602, -46.04248383, -46.04257654, -46.04153278, -46.04344757, -46.04234606, -46.04244858, -46.04433441, -46.04099030, -46.04294730, -46.04069637, -46.04328866, -46.04105118, -46.04628503, -46.04084980, -46.04106690, -46.04343929, -46.04323803, -46.04619767];
e0D12=[-45.93505494, -45.80865890, -45.89496671, -45.91659634, -45.92585614, -45.93070803, -45.93363193, -45.93390561, -45.94148084, -45.94184842, -45.94217583, -45.94437626, -45.94650180, -45.95441204, -45.95100260, -45.95404659, -45.95319840, -45.95734597, -45.95570094, -45.95587102, -45.95767486, -45.95941509, -45.96097597, -45.96332132, -45.96587146, -45.96667177, -45.96507039, -45.96733409, -45.96643382, -45.96855969, -45.97206141, -45.97180112, -45.97347759, -45.97570029, -45.97363531, -45.97405766, -45.97221712, -45.97547076, -45.98066217, -45.98010865, -45.97819700, -45.97688056, -45.97810341, -45.98239082, -45.97936282, -45.97959058, -45.97545631, -45.98700243, -45.98496250, -45.98405635, -45.97980913, -45.98356628, -45.98696000, -45.99318060, -45.98661027, -45.98527233, -45.99285350, -45.98724123, -45.98655220, -45.98800387, -45.98748661, -45.99182450, -45.99632184, -45.99327038, -45.99457050, -45.99204232, -45.99399922, -45.99476630, -45.99258054, -45.99765849, -45.99796509, -45.99561535, -45.99704793, -45.99606025, -45.99710101, -45.99784434, -45.99929328, -46.00100607, -45.99790534, -46.00421287, -46.00076077, -46.00282327, -46.00360607, -46.00141786, -46.00303743, -46.00277730, -46.00431461, -45.99947542, -46.00694049, -46.00507297, -46.00370684, -46.00373392, -46.01063832, -46.00737595, -46.00650595, -46.00367036, -46.00806755, -46.00747301, -46.00424212, -46.01058975, -46.00814744, -46.00818900, -46.01221032, -46.01256277, -46.00715941, -46.01201591, -46.01075737, -46.00768834, -46.01332319, -46.01066722, -46.01028429, -46.00903473, -46.01410076, -46.01665100, -46.01305933, -46.01677110, -46.01341529, -46.01887848, -46.01844555, -46.01841896, -46.01991521, -46.01912418, -46.01457688, -46.01517595, -46.01799308, -46.01684981, -46.01807548, -46.01831305, -46.01974564, -46.01662186, -46.01946723, -46.02318749, -46.02297485, -46.01514746, -46.02038458, -46.02012993, -46.01858487, -46.01977542, -46.01974897, -46.02291989];
e0_dmrgD12000 = -45.8487302919809991; %dmrg 12000 state
e0_dmrgD15000 =-45.8518218920220804; %dmrg 15000 state

h0=plot(e0D8([1,3:end]), 'o','LineWidth', 2); hold on;
h1=plot(e0D8iPEPS([1,3:end]), 'o','LineWidth', 2); hold on;
h2=plot(e0D10([1,3:end]), 'o','LineWidth', 2); hold on;
h3=plot(e0D12([1,3:end]), 'o','LineWidth', 2); hold on;
h4=yline(e0_dmrgD12000, 'b--');
h5=yline(e0_dmrgD15000, 'b--');

% T=text(200,0.03,['$4\times 4$, PEPS $D=8$', char(10),...
%                 'Boundary MPS $\chi=24$', char(10),...
%                 'Typical step length $\alpha = 0.2$', char(10),...
%                 'Typical Samples = 56 chains $\times 2000$.']);
% set(T,'Interpreter','latex');
% set(T,'Fontsize',18);

% 
l=legend([h0, h1, h2,h3, h4,h5], {'$D=8$', '$D=8$ from iPESS state', ...
    '$D=10$', '$D=12$', ...
    'DMRG $D=12000$', ... %$\alpha=0.3$ for initial and final stage, varies in middle stage
    'DMRG, $D=15000$'});
set(l,'Box','off');set(l,'Interpreter','latex');
set(l,'Fontsize',18);
set(l,'Location','NorthEast');

xlabel('Iteration','Interpreter','latex')
% ylabel('Persite energy $e_0$','Interpreter','latex')
ylabel('total energy','Interpreter','latex')
set(gca,'fontsize',24);
set(gca,'linewidth',1.5);
set(get(gca,'Children'),'linewidth',2); % Set line width 1.5 pounds
set(get(gca,'XLabel'),'FontSize',24);
set(get(gca,'YLabel'),'FontSize',24);
set(gcf, 'position',  [100, 100, 1300, 600]);

set(gca, 'Ylim', [-inf, -45.75]);
% set(gca, 'Xlim', [0, 200]);

hold off;

figure_directory = './';
figure_name_eps = 'EnergyDecreasingKagome6x6.eps';
figure_path = fullfile(figure_directory, figure_name_eps);
saveas(gcf, figure_path, 'epsc');
disp(['Energy deceasing of the heisenberg model: ', figure_path]);