e0D8=[-45.87612868, -44.73217172, -45.85571876, -45.86839622, -45.87764624, -45.88503151, -45.89210967, -45.89016815, -45.89820101, -45.89622139, -45.89776091, -45.89776379, -45.89886120, -45.90073328, -45.90332423, -45.90658685, -45.90604058, -45.90634302, -45.90619303, -45.91478236, -45.91217931, -45.91060428, -45.91233211, -45.91575235, -45.92350948, -45.91770245, -45.91832596, -45.92680015, -45.91926939, -45.92177277, -45.92447348, -45.91702192, -45.92719744, -45.92742357, -45.92518211, -45.92472429, -45.92152860, -45.92881520, -45.92675269, -45.92777493, -45.92940476, -45.92860897, -45.93226869, -45.93367709, -45.93606511, -45.93576531, -45.93446195, -45.93437949, -45.93642953, -45.93572739, -45.93571627, -45.93390587, -45.93798914, -45.93880615, -45.93835991, -45.93610383, -45.94321653, -45.94319634, -45.94550603, -45.94309576, -45.94367544, -45.94465764, -45.94024031, -45.94075049, -45.94946018, -45.94502641, -45.94293258, -45.95048286, -45.94549812, -45.95024698, -45.94979185, -45.94734157, -45.94632342, -45.94648554, -45.94928414, -45.95217296, -45.95442400, -45.94954391, -45.95164006, -45.94891367, -45.95123747, -45.95221017, -45.95210968, -45.95568580, -45.95740669, -45.95145499, -45.95485848, -45.95037429, -45.95686627, -45.95118520, -45.95569534, -45.95576177, -45.95918086, -45.95588685, -45.95727913, -45.96053919, -45.95880892, -45.95298333, -45.95973444, -45.95049042, -45.95659796, -45.96249994, -45.95649503, -45.95587082, -45.95869138, -45.96230541, -45.96011186, -45.95809449, -45.96403569, -45.96159084, -45.95931521, -45.96262623, -45.95782926, -45.96560957, -45.96765394, -45.96390467, -45.95928646, -45.96641483, -45.96391515, -45.96205423, -45.96230446, -45.95805143, -45.96084287, -45.96972297, -45.96258313, -45.96352104, -45.96692961, -45.97453523, -45.96828944, -45.96656185, -45.97350922, -45.96972989, -45.97081205, -45.96191452, -45.96936542, -45.96953189, -45.97062923, -45.97013187, -45.96745616, -45.96811923, -45.96924181, -45.96501585, -45.97082876, -45.96643266, -45.96676604, -45.96382037, -45.97110034, -45.96709856, -45.97321499, -45.97145634, -45.97337880, -45.97101720, -45.97373001, -45.97074866, -45.97424709, -45.97463503, -45.97791070, -45.97614429, -45.97871689, -45.97410087, -45.97478602, -45.97244406, -45.97396488, -45.97768523, -45.97506232, -45.97777897, -45.97237874, -45.97619431, -45.97168532, -45.97470863, -45.97868154, -45.97700311, -45.97644613, -45.97750735, -45.98159032, -45.97215093, -45.97800160, -45.97638092, -45.97604082, -45.97843615, -45.97052694, -45.98283192, -45.97523570, -45.97644481, -45.97809980, -45.97908938, -45.97334888, -45.97347141, -45.97904089, -45.98024340, -45.98171372, -45.97861277, -45.98124788, -45.97476650, -45.98016990, -45.98242826, -45.98140412, -45.98091651, -45.97933890, -45.98006057, -45.98433164, -45.97606812, -45.98147968, -45.98088231, -45.97811377, -45.98236141, -45.98568861, -45.98747218, -45.98725925, -45.98486282, -45.98028781, -45.97921444, -45.97551491, -45.98364561, -45.97949512, -45.98060075, -45.97370612, -45.97482571, -45.97588482, -45.98129421, -45.97381554, -45.98209707, -45.98035897, -45.97971913, -45.98189933, -45.98389128, -45.97903011, -45.98351201, -45.98265594, -45.97808077, -45.98162647, -45.97883820, -45.98341568, -45.98944235, -45.97940549, -45.97940938, -45.98511730, -45.98467336, -45.99187672, -45.98922868, -45.98974172, -45.98759627, -45.97899371, -45.98525749, -45.98272960, -45.97803037, -45.98973909, -45.98604645, -45.98626081, -45.98628741, -45.98858151, -45.99099450, -45.99505755, -45.98580831, -45.98743172, -45.98878927, -45.99098349, -45.99003827, -45.98786063, -45.98760942, -45.99237486, -45.99576810, -45.99132710, -45.99045819, -45.98837579, -45.99462414, -45.99351968, -45.99227398, -45.99373407, -45.99947328, -45.99439567, -45.99618698, -45.99701528, -45.99964771, -45.99515690, -45.99674313, -45.99761444, -45.99185457, -45.99560783, -45.99751539, -45.99875487, -45.99390302, -45.99676353, -45.99665221, -46.00208395, -46.00069488, -45.99819910, -45.99947882, -45.99603444, -45.99755396, -46.00232335, -45.99948803, -46.00422309, -46.00137114, -46.00704713, -46.00179468, -45.99900620, -46.00024099, -45.99364539, -46.00420048, -46.00321187, -46.00422044, -46.00461900, -46.00492271, -46.00283118, -46.00472338, -46.00090036, -46.00722813, -46.00627865, -46.00262219, -46.00552898, -46.00518888, -46.00857152, -46.00796834, -46.00691415, -46.00686190, -46.00830031, -46.00877618, -46.00475548, -46.01199698, -46.00611763, -46.00847248, -46.01074668, -46.00621848, -46.00702083, -46.01085246, -46.01249141, -46.00576306, -46.00326773, -46.01170498, -46.00818871, -46.01272977, -46.01463961, -46.01408676, -46.01262576, -46.01386426, -46.01211506, -46.01430207, -46.01047760, -46.01420397, -46.01451597, -46.01183551, -46.01498478, -46.01738927, -46.01420551, -46.01435436, -46.01628870, -46.01351461, -46.01589918, -46.01641586, -46.01555580, -46.01214797, -46.01637148, -46.01622563, -46.01877866, -46.01668655, -46.01931671, -46.01903414, -46.01980433];
e0D10=[-45.91265394, -45.85477841, -45.90564304, -45.91770935, -45.92148000, -45.92377547, -45.93167525, -45.92854557, -45.93144681, -45.93994571, -45.93545882, -45.94066798, -45.93847801, -45.94473501, -45.94503028, -45.94583644, -45.94690206, -45.94898585, -45.95195738, -45.95213312, -45.95184583, -45.95473272, -45.95179290, -45.95722119, -45.95935117, -45.96037666, -45.96028352, -45.96208361, -45.96045396, -45.96219659, -45.96588938, -45.96771858, -45.96955205, -45.96801001, -45.96726750, -45.96535917, -45.97005759, -45.96725904, -45.97590419, -45.97300403, -45.97206024, -45.97288837, -45.97397323, -45.97418051, -45.97733086, -45.97559970, -45.97620307, -45.98146999, -45.97741634, -45.97927629, -45.97999143, -45.97927456, -45.98160508, -45.98072709, -45.98336356, -45.98413707, -45.98340905, -45.98260672, -45.98809161, -45.98555017];
e0D12=[-45.93505494, -45.80865890, -45.89496671, -45.91659634, -45.92585614, -45.93070803, -45.93363193, -45.93390561, -45.94148084, -45.94184842, -45.94217583, -45.94437626, -45.94650180, -45.95441204, -45.95100260, -45.95404659, -45.95319840, -45.95734597, -45.95570094, -45.95587102];

e0_dmrgD12000 = -45.8487302919809991; %dmrg 12000 state
e0_dmrgD15000 =-45.8517860703602764; %dmrg 15000 state

h0=plot(e0D8([1,3:end]), 'o','LineWidth', 2); hold on;
h0=plot(e0D10([1,3:end]), 'o','LineWidth', 2); hold on;
h0=plot(e0D12([1,3:end]), 'o','LineWidth', 2); hold on;
yline(e0_dmrgD12000, 'b--');
yline(e0_dmrgD15000, 'b--');

% T=text(200,0.03,['$4\times 4$, PEPS $D=8$', char(10),...
%                 'Boundary MPS $\chi=24$', char(10),...
%                 'Typical step length $\alpha = 0.2$', char(10),...
%                 'Typical Samples = 56 chains $\times 2000$.']);
% set(T,'Interpreter','latex');
% set(T,'Fontsize',18);

% 
% l=legend([h0, h1, h2,h3, h4,h5], {'SR, $D=8$', 'Gradient, $D=8$', ...
%     'Gradient, $D=8, \alpha = 0.01$', 'SR, $D=10, \alpha = 0.2$', ...
%     'SR, $D=10$', ... %$\alpha=0.3$ for initial and final stage, varies in middle stage
%     'SR, $D=12$'});
% set(l,'Box','off');set(l,'Interpreter','latex');
% set(l,'Fontsize',18);
% set(l,'Location','NorthEast');

xlabel('Iteration','Interpreter','latex')
% ylabel('Persite energy $e_0$','Interpreter','latex')
ylabel('energy relative error','Interpreter','latex')
set(gca,'fontsize',24);
set(gca,'linewidth',1.5);
set(get(gca,'Children'),'linewidth',2); % Set line width 1.5 pounds
set(get(gca,'XLabel'),'FontSize',24);
set(get(gca,'YLabel'),'FontSize',24);
set(gcf, 'position',  [100, 100, 1300, 600]);
hold off;

figure_directory = './';
figure_name_eps = 'EnergyDecreasingKagome6x6.eps';
figure_path = fullfile(figure_directory, figure_name_eps);
saveas(gcf, figure_path, 'epsc');
disp(['Energy deceasing of the heisenberg model: ', figure_path]);