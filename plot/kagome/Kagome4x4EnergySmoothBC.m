e0D4=[-17.53938461, -17.57092124, -17.59159003, -17.60102288, -17.60902819, -17.61479376, -17.61966464, -17.62360696, -17.62718099, -17.62996544, -17.63385929, -17.63849859, -17.63270500, -17.64249875, -17.64560657, -17.64883146, -17.64823611, -17.65063825, -17.65199289, -17.65374583, -17.65056999, -17.65565772, -17.65736782, -17.64924792, -17.66043833, -17.66257122, -17.66086105, -17.66169230, -17.66382638, -17.66179908, -17.66473101, -17.66763514, -17.66708023, -17.66931827, -17.66899957, -17.66832034, -17.66929172, -17.67093081, -17.66989684, -17.66939818, -17.67121848, -17.66924472, -17.67282984, -17.66942215, -17.67158651, -17.67110184, -17.67197984, -17.67303885, -17.67162569, -17.67265557, -17.67220672, -17.67139764, -17.67170842, -17.67228915, -17.67141744, -17.67341988, -17.67190542, -17.67481113, -17.67212538, -17.67260636, -17.67458333, -17.67373896, -17.67378585, -17.67453015, -17.67489488, -17.67575431, -17.67196391, -17.67364800, -17.67478625, -17.67493322, -17.67611822, -17.67570845, -17.67621589, -17.67663613, -17.67544608, -17.67709006, -17.67526892, -17.67354671, -17.67572471, -17.67462939, -17.67581380, -17.67513466, -17.67370793, -17.67537485, -17.67487483, -17.67549266, -17.67689430, -17.67630750, -17.67627805, -17.67675897, -17.67615644, -17.67421353, -17.67763298, -17.67601166, -17.67696377, -17.67703947, -17.67638141, -17.67674598, -17.67513693, -17.67593281, -17.67492574, -17.67418266, -17.67735805, -17.67726937, -17.67768030, -17.67814584, -17.67617825, -17.67638292, -17.67462601, -17.67680872, -17.67762845, -17.67743157, -17.67742672, -17.67822474, -17.67709235, -17.67640629, -17.67743833, -17.67741330, -17.67724061, -17.67481401, -17.67749356, -17.67672337, -17.67808776, -17.67716424, -17.67806492, -17.67797255, -17.67680001, -17.67768174, -17.67838968, -17.67805365];
e0D8=[-17.67338553, -17.63467841, -17.68002225, -17.67998726, -17.68151125, -17.68326983, -17.68222865, -17.68521399, -17.68416637, -17.68578095, -17.68673052, -17.68739650, -17.68752619, -17.68825545, -17.69048656, -17.68988652, -17.69079950, -17.69160102, -17.69096777, -17.69223894, -17.69332356, -17.69308876, -17.69382954, -17.69303235, -17.69375886, -17.69501938, -17.69453690, -17.69493353, -17.69468116, -17.69448823, -17.69590989, -17.69594481, -17.69561726, -17.69532555, -17.69477312, -17.69555427, -17.69553202, -17.69610586, -17.69669273, -17.69619989, -17.69720627, -17.69670916, -17.69708841, -17.69642990, -17.69576230, -17.69740406, -17.69593157, -17.69627656, -17.69666631, -17.69705594, -17.69764811, -17.69631991, -17.69742853, -17.69708081, -17.69672885, -17.69817969, -17.69597846, -17.69705347, -17.69824687, -17.69858567, -17.69811660, -17.69682300, -17.69846479, -17.69698282, -17.69813274, -17.69774790, -17.69763525, -17.69868776, -17.69806674, -17.69833212, -17.69865162, -17.69707535, -17.69684869, -17.69692725, -17.69814700, -17.69757221, -17.69738397, -17.69857111, -17.69896964, -17.69795757, -17.69776541, -17.69782063, -17.69709391, -17.69747072, -17.69833757, -17.69798217, -17.69708370, -17.69722966, -17.69807963, -17.69716125, -17.69672080, -17.69860332, -17.69757025, -17.69918356, -17.69776916, -17.69785501, -17.69837941, -17.69795523, -17.69868070, -17.69753654, -17.69787387, -17.69843909, -17.69824010, -17.69819498, -17.69841989, -17.69731509, -17.69820809, -17.69766772, -17.69816854, -17.69858931, -17.69798289, -17.69873979, -17.69818788, -17.69818175, -17.69842765, -17.69834876, -17.69834528, -17.69828470, -17.69795638, -17.69794657, -17.69830783, -17.69866002, -17.69876649, -17.69859152, -17.69808519, -17.69846738, -17.69869460, -17.69816410, -17.69860300, -17.69854235, -17.69887187, -17.69844336, -17.69891667, -17.69854994, -17.69865740, -17.69877783, -17.69882157, -17.69837665, -17.69861122, -17.69876372, -17.69849989, -17.69908160, -17.69893599, -17.69879903, -17.69820251, -17.69845594, -17.69839625, -17.69884206, -17.69856448, -17.69859809, -17.69911899, -17.69863592, -17.69915900, -17.69837916, -17.69857663, -17.69866771, -17.69929890, -17.69883066, -17.69880237, -17.69852914, -17.69880209, -17.69865313, -17.69895247, -17.69884941, -17.69866239, -17.69855484, -17.69868931, -17.69940046, -17.69908197, -17.69848594, -17.69856287, -17.69874244, -17.69898599, -17.69824793, -17.69849310, -17.69847245, -17.69881423, -17.69842781, -17.69912805, -17.69887837, -17.69898854, -17.69846679, -17.69878656, -17.69879745, -17.69902496, -17.69881692, -17.69879944, -17.69929352, -17.69929061, -17.69884415, -17.69902062, -17.69956614, -17.69884749, -17.69907733, -17.69915970, -17.69898750, -17.69876233, -17.69869914, -17.69894179, -17.69893238, -17.69868462, -17.69894978, -17.69900273, -17.69903425, -17.69887172, -17.69911838, -17.69916494, -17.69936406, -17.69943090, -17.69922718, -17.69917089, -17.69921823, -17.69943369, -17.69916494, -17.69936730, -17.69890427, -17.69925936, -17.69916077, -17.69917006, -17.69912963];
e0D10=[-17.68350710, -17.64387860, -17.68764359, -17.69057180, -17.69140072, -17.69112337, -17.69203306, -17.69306341, -17.69276972, -17.69419095, -17.69295470, -17.69491709, -17.69491501, -17.69630597, -17.69543859, -17.69585221, -17.69526235, -17.69540068, -17.69611955, -17.69641315, -17.69612740, -17.69686434, -17.69620894, -17.69658360, -17.69664601, -17.69734077, -17.69736601, -17.69714016, -17.69703955, -17.69681907, -17.69752987, -17.69723210, -17.69771385, -17.69809045, -17.69761482, -17.69686445, -17.69807247, -17.69788047, -17.69868248, -17.69714060, -17.69739748, -17.69802558, -17.69835574, -17.69821912, -17.69810373, -17.69794442, -17.69801673, -17.69795852, -17.69798612, -17.69790454, -17.69871946, -17.69887945, -17.69851245, -17.69932554, -17.69814371, -17.69846918, -17.69874250, -17.69853833, -17.69834270, -17.69948773, -17.69837258, -17.69914268, -17.69865561, -17.69860167, -17.69817605, -17.69818851, -17.69891821, -17.69896113, -17.69846024, -17.69894947, -17.69883784, -17.69868485, -17.69863426, -17.69900181, -17.69905633, -17.69794630, -17.69919988, -17.69920134, -17.69870662, -17.69799718, -17.69873791, -17.69836132, -17.69839611, -17.69914626, -17.69862469, -17.69800181, -17.69899127, -17.69930070, -17.69885098, -17.69847180, -17.69799809, -17.69859593, -17.69912245, -17.69885752, -17.69833341, -17.69912149, -17.69888876, -17.69925804, -17.69896522, -17.69851686, -17.69871505, -17.69885460, -17.69904725, -17.69913823, -17.69913731, -17.69884273, -17.69922092, -17.69923626, -17.69953863, -17.69952353, -17.69941059, -17.69955029, -17.69933006, -17.69944943, -17.69943200, -17.69964626, -17.69922732, -17.69923451, -17.69937839, -17.69953287, -17.69960716, -17.69953495, -17.69963551, -17.69963906, -17.69960468, -17.69953707, -17.69938503, -17.69962080, -17.69938500, -17.69976494];
e0D12=[-17.68639658, -17.64253207, -17.68953557, -17.69140142, -17.69144812, -17.69275542, -17.69327012, -17.69236321, -17.69306225, -17.69488095, -17.69429017, -17.69453532, -17.69465694, -17.69380702, -17.69542808, -17.69571841, -17.69687496, -17.69580727, -17.69630971, -17.69705641, -17.69761034, -17.69703214, -17.69653303, -17.69776028, -17.69693585, -17.69661533, -17.69724250, -17.69812837, -17.69769298, -17.69661144, -17.69719772, -17.69727152, -17.69691387, -17.69767659, -17.69759158, -17.69776746, -17.69827527, -17.69810149, -17.69805369, -17.69820113, -17.69768753, -17.69858284, -17.69845941, -17.69823641, -17.69823340, -17.69823285, -17.69745096, -17.69858603, -17.69782001, -17.69835886, -17.69825479, -17.69909796, -17.69715696, -17.69805692, -17.69941109, -17.69862310, -17.69765008, -17.69901525, -17.69949778, -17.69897963, -17.69898289, -17.69891500, -17.69930594, -17.69887428, -17.69920468, -17.69839064, -17.69849834, -17.69815926, -17.69872348, -17.69832803, -17.69866013, -17.69955509, -17.69840081, -17.69883363, -17.69884412, -17.69998732, -17.69893689, -17.69884348, -17.69904679, -17.69897532, -17.69896081, -17.69850157, -17.69955462, -17.69876788, -17.69894808, -17.69923083, -17.69926536, -17.69909873, -17.69894248, -17.69929590, -17.69892585, -17.69849928, -17.69888029, -17.69866779, -17.69861082, -17.69833771, -17.69917998, -17.69904086, -17.69895577, -17.69947553];

e0_ex =[-17.7000849491833883];
% h0=semilogy((e0D4 -e0_ex)/abs(e0_ex), 'o','LineWidth', 2); hold on;
% h1=semilogy((e0D8 -e0_ex)/abs(e0_ex), 'o','LineWidth', 2); hold on;

h1=plot(e0D4, 'o' ,'LineWidth', 2); hold on;
h2=plot(e0D8, 'o' ,'LineWidth', 2); hold on;
h3=plot(e0D10, 'o' ,'LineWidth', 2); hold on;
h4=plot(e0D12, 'o' ,'LineWidth', 2); hold on;

yline(e0_ex,'r--');

l=legend([h1, h2,h3,h4], {'$D=4$', '$8$', ...
    ' $10$', '12'});
set(l,'Box','off');set(l,'Interpreter','latex');
set(l,'Fontsize',18);
set(l,'Location','NorthWest');

xlabel('Iteration','Interpreter','latex')
% ylabel('Persite energy $e_0$','Interpreter','latex')
ylabel('energy','Interpreter','latex')
set(gca,'fontsize',24);
set(gca,'linewidth',1.5);
set(get(gca,'Children'),'linewidth',2); % Set line width 1.5 pounds
set(get(gca,'XLabel'),'FontSize',24);
set(get(gca,'YLabel'),'FontSize',24);
set(gcf, 'position',  [100, 100, 1000, 600]);
set(gca, 'Ylim', [-17.73, inf]);
hold off;

inset_axes = axes('Position', [0.5, 0.5, 0.35, 0.35]);
plot((e0D4 - e0_ex) / abs(e0_ex), 'o', 'LineWidth', 2);hold on;
plot((e0D8 - e0_ex) / abs(e0_ex), 'o', 'LineWidth', 2);
plot((e0D10 - e0_ex) / abs(e0_ex), 'o', 'LineWidth', 2);
plot((e0D12 - e0_ex) / abs(e0_ex), 'o', 'LineWidth', 2);

set(gca, 'YScale', 'log');
set(gca, 'fontsize', 16);
set(gca, 'linewidth', 1.5);
set(get(gca, 'Children'), 'linewidth', 2);
ylabel('energy relative error','Interpreter','latex')
box on;


figure_directory = './';
figure_name_eps = 'EnergyDecreasingKagome4x4SmoothBC.eps';
figure_path = fullfile(figure_directory, figure_name_eps);
saveas(gcf, figure_path, 'epsc');
disp(['Energy deceasing of the heisenberg model: ', figure_path]);