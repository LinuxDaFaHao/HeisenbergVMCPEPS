e0=[-45.87612868, -44.73217172, -45.85571876, -45.86839622, -45.87764624, -45.88503151, -45.89210967, -45.89016815, -45.89820101, -45.89622139, -45.89776091, -45.89776379, -45.89886120, -45.90073328, -45.90332423, -45.90658685, -45.90604058, -45.90634302, -45.90619303, -45.91478236, -45.91217931, -45.91060428, -45.91233211, -45.91575235, -45.92350948, -45.91770245, -45.91832596, -45.92680015, -45.91926939, -45.92177277, -45.92447348, -45.91702192, -45.92719744, -45.92742357, -45.92518211, -45.92472429, -45.92152860, -45.92881520, -45.92675269, -45.92777493, -45.92940476, -45.92860897, -45.93226869, -45.93367709, -45.93606511, -45.93576531, -45.93446195, -45.93437949, -45.93642953, -45.93572739, -45.93571627, -45.93390587, -45.93798914, -45.93880615, -45.93835991, -45.93610383, -45.94321653, -45.94319634, -45.94550603, -45.94309576, -45.94367544, -45.94465764, -45.94024031, -45.94075049, -45.94946018, -45.94502641, -45.94293258, -45.95048286, -45.94549812, -45.95024698, -45.94979185, -45.94734157, -45.94632342, -45.94648554, -45.94928414, -45.95217296, -45.95442400, -45.94954391, -45.95164006, -45.94891367, -45.95123747, -45.95221017, -45.95210968, -45.95568580, -45.95740669, -45.95145499, -45.95485848, -45.95037429, -45.95686627, -45.95118520, -45.95569534, -45.95576177, -45.95918086, -45.95588685, -45.95727913, -45.96053919, -45.95880892, -45.95298333, -45.95973444, -45.95049042, -45.95659796, -45.96249994, -45.95649503, -45.95587082, -45.95869138, -45.96230541, -45.96011186, -45.95809449, -45.96403569, -45.96159084, -45.95931521, -45.96262623, -45.95782926, -45.96560957, -45.96765394, -45.96390467, -45.95928646, -45.96641483, -45.96391515, -45.96205423, -45.96230446, -45.95805143, -45.96084287, -45.96972297, -45.96258313, -45.96352104, -45.96692961, -45.97453523, -45.96828944, -45.96656185, -45.97350922, -45.96972989, -45.97081205, -45.96191452, -45.96936542, -45.96953189, -45.97062923, -45.97013187, -45.96745616, -45.96811923, -45.96924181, -45.96501585, -45.97082876, -45.96643266, -45.96676604, -45.96382037, -45.97110034, -45.96709856, -45.97321499, -45.97145634, -45.97337880, -45.97101720, -45.97373001, -45.97074866, -45.97424709, -45.97463503, -45.97791070, -45.97614429, -45.9787168];
e0_dmrg =0; %dmrg 4000 state

h0=plot(e0([1,3:end]), 'o','LineWidth', 2); hold on;
% 
% T=text(200,0.03,['$4\times 4$, PEPS $D=8$', char(10),...
%                 'Boundary MPS $\chi=24$', char(10),...
%                 'Typical step length $\alpha = 0.2$', char(10),...
%                 'Typical Samples = 56 chains $\times 2000$.']);
% set(T,'Interpreter','latex');
% set(T,'Fontsize',18);

% 
% l=legend([h0, h1, h2,h3, h4,h5], {'SR, $D=8$', 'Gradient, $D=8$', ...
%     'Gradient, $D=8, \alpha = 0.01$', 'SR, $D=10, \alpha = 0.2$', ...
%     'SR, $D=10$', ... %$\alpha=0.3$ for initial and final stage, varies in middle stage
%     'SR, $D=12$'});
% set(l,'Box','off');set(l,'Interpreter','latex');
% set(l,'Fontsize',18);
% set(l,'Location','NorthEast');

xlabel('Iteration','Interpreter','latex')
% ylabel('Persite energy $e_0$','Interpreter','latex')
ylabel('energy relative error','Interpreter','latex')
set(gca,'fontsize',24);
set(gca,'linewidth',1.5);
set(get(gca,'Children'),'linewidth',2); % Set line width 1.5 pounds
set(get(gca,'XLabel'),'FontSize',24);
set(get(gca,'YLabel'),'FontSize',24);
set(gcf, 'position',  [100, 100, 1300, 600]);
hold off;

figure_directory = './';
figure_name_eps = 'EnergyDecreasingKagome6x6.eps';
figure_path = fullfile(figure_directory, figure_name_eps);
saveas(gcf, figure_path, 'epsc');
disp(['Energy deceasing of the heisenberg model: ', figure_path]);